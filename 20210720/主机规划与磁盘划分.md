<h1 style="text-align:center">主机规划与磁盘划分</h1>
<h2 style="background-color:orange">Concept</h2>
引导加载程序(Boot loader)

启动扇区(Boot sector)

<h2 style="background-color:blue">Point</h2>

多重引导

在开始安装Linux之前，应该思考以下事项：
1. distributions的特性
2. 服务器软件的能力
3. 未来的升级需求
4. 硬件扩充需求

为什么需要磁盘分区？
文件系统是什么？
Linux频繁操作的目录有哪些？

# 3.1 Linux与硬件的搭配。

## 3.1.1 选择与Linux搭配的主机配置

Linux Kernel针对新硬件所纳入的驱动程序模块比不上硬件更新的速度，加上硬件厂商针对Linux所推出的驱动程序较慢，因此选择主机时，建议选择已经安装过Linux测试的硬件比较好。

此外，在安装Linux之前，最好先明确你的需求。举例来说，桌面计算机用户一般都会用到X Window系统，此时显卡的优劣和内存的大小就占有较大比重。如果是要做成文件服务器，那么硬盘等存储设备就很重要了。

Linux对于计算机各组件/设备的分辨和Windows不同，<mark>各个组件或设备在Linux下面都是一个文件</mark>。

## 3.1.2 各硬件设备在Linux中的文件名

```
/dev/hd/[a-d]    IDE硬盘
/dev/sd/[a-p]    SCSI/SATA/USB硬盘
/dev/fd[0-1]     软驱
/dev/lp[0-2]     打印机(25针)
/dev/usb/lp[0-15]    打印机
/dev/usb/mouse[0-15]     鼠标
...
```

# 3.2 磁盘分区

SATA/USB接口的磁盘文件名由Linux内核检测到磁盘的顺序决定。

## 磁盘的组成

盘片、机械手臂、磁头和主轴马达

1. 盘片
+ 扇区(Sector)

一个扇区512bytes.磁盘的第一个扇区非常重要，它主要记录了两个重要的信息：

(1) 主引导分区(Master Boot Recorder),安装**引导加载程序的地方**,有446bytes;
(2) 分区表(partition table),记录分区的状态，有64bytes

MBR是很重要的，因为当系统开机的时候会主动读取这个区块的内容，这样系统才会知道你的程序放在哪里且该如何进行开机。
+ 柱面(Cylinder)

## 磁盘分区表(partition)

新硬盘就像一根原木，你必须在这根原木上面切割加工才能做成文件柜，存储资料。**柱面**是文件系统的最小单位，也是分区的最小单位。在分区表(64bytes)中,分为四组记录区，每组记录区记录了该区段包含的柱面的编号。

### 主分区、扩展分区和逻辑分区的特性

1. 主分区和扩展分区最多有4个(硬盘限制)

第一个扇区只有64bytes分配给分区表。然后以根分区要占有16bytes

2. 逻辑分区最多只能有一个。

3. 逻辑分区是由扩展分区持续切割出来的分区

4.能够被格式化后作为数据访问的分区为主分区和逻辑分区。扩展分区无法格式化。

5. 逻辑分区的数量依操作系统而不同，Linux系统中，IDE硬盘最多有59个分区(5-63),SATA硬盘则有11个逻辑分区(5-15)。
Primary  Extended  logical 
primary and extended 使用1 2 3 4
logical partition 使用5 6 . . .

主分区记录分区信息(柱面编码)
扩展分区的目的是使用额外的扇区   
为什么要进行磁盘分区？

1. 数据安全

每个分区的数据是分开的。所以，当你需要重整某个分区的数据时，其他分区的数据不受影响。举例来说，重新安装C盘的操作系统不会影响D盘。

2. 系统性能

由于分区将数据集中在某个柱面的区段。例如，第一个分区由柱面编码为1-100的柱面组成。当有数据要读取自该分区时，磁盘只会搜索1-100的柱面范围，由于数据集中了，将有助于数据读取的速度与性能。

### 开机流程与主引导分区(MBR)

BIOS写入到主板的一个软件程序。
CMOS记录各项硬件参数且嵌入在主板上面的存储器。

BIOS和Boot loader都是软件程序
BIOS 依据用户设置去取得能够开机的硬盘，并在该硬盘里面读取第一个扇区内的MBR
Boot loader(存放在MBR） 加载(load)内核文件到内存中
内核文件: 开始操作系统的功能

由上面的说明可以得知，BIOS和MBR是硬件本身支持的功能，至于Boot loader则是操作系统安装在MBR上面的一个大小为446bytes的软件。这个Boot loader的主要任务有下面这些项目：

+ 提供菜单：用户可以选择不同开机选项，这也是多重引导的重要功能
+ 载入内核文件：
+ 转交给其他loader

<mark>Point GRUB(多重引导)</mark>

多重引导用于在同一台主机上安装多个操作系统；

loader识别并加载内核文件到内存中；

loader只会认识自己的系统分区内的可开机内核文件，以及其他loader；

boot loader是一款软件，它只能安装在MBR和boot sector

安装多重引导，最好先安装Windows：

因为Windows安装的时候，它的安装程序会主动覆盖MBR以及自己所在分区的启动扇区。因此如果先安装Linux的话，Linux的loader会被覆盖，再次开机时会导致
Linux系统无法启动。

# 3.3 Linux安装模式，磁盘分区的选择

1. 目录树(directory tree)

2. 文件系统和目录树的关系(mount)

磁盘分区挂载到目录树上

# 3.4 安装Linux前的规划

## 3.4.1 选择适当的distributions

## 3.4.2 主机服务规划与硬件功能

1. NAT(达到路由器功能)

单纯利用Linux作为NAT主机很不明智，因为PC的耗电能力比路由器大得多。但使用Linux作为NAT可以加装很多额外的分析软件。

2. SAMBA

3. DHCP

4. Proxy

